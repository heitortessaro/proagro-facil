version: '3.9'
services:
  db:
    image: mongo
    container_name: db
    platform: linux/x86_64
    restart: always
    ports:
      - 27017:27017
    volumes:
      - ~/apps/mongo:/data/db

  frontend:
    build: ./frontend
    ports:
      - 3000:3000
    platform: linux/x86_64
    working_dir: /app-frontend
    volumes:
      -   ./frontend/src:/app-backend/src
    # depends_on:
    #   backend:
    #     condition: service_healthy
    # # Os `healthcheck` devem garantir que a aplicação
    # # está operacional, antes de liberar o container
    # healthcheck:
    #   test: ["CMD", "lsof", "-t", "-i:3000"]  # Caso utilize outra porta interna para o front, altere ela aqui também
    #   timeout: 10s
    #   retries: 5